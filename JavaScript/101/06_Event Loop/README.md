### 목차

[프로세스와 쓰레드의 차이](#프로세스_쓰레드)

[자바스크립트 런타임 환경](#엔진_스택)

[브라우저 런타임 환경 이해](#브라우저_런타임_환경_큐)

[전반적인 큰 그림](#큰_그림)

[setTimeout](#setTimeout)

[Promise](#Promise)

[RAF](#RAF)

<br />

---

<br />

### 프로세스_쓰레드

<br />

![Process](./imgs/Process.png)

* Process 프로세스 

  컴퓨터 위, 즉 운영체제 위에서 연속적으로 실행되고 있는 프로그램

  프로그램은 각각의 프로세스를 가지고 있다

  프로세스는 메모리 위에서 독립적으로 실행된다

  각각의 프로세스는 저마다 리소스 자원들이 정해져 있다

  즉 프로세스마다 할당된 메모리나 데이터들이 지정되어져 있다

  프로세스 안에는 프로그램을 위해서 작성된 코드와 

  그 프로세스 안에서 함수들이 어떤 순서로 실행되어야 하는지 이 함수가 끝나면 어디로 다시 돌아가야 하는지에 대한 정보 저장한 스택이 있고 

  힙은 오브젝트를 생성하거나 데이터를 만들 때 그 데이터들이 저장되는 공간

  힙에는 동적으로 할당된 변수들이 저장된 저장되고, 데이터에는 전역 변수나 스태틱 변수들이 할당

  => 각각의 프로세스는 코드, 동작하고 있는 순서를 기억하는 스택, 데이터들이 들어있는 힙과 데이터들이 들어가있다

<br />

![Thread](./imgs/Thread.png)

* Thread 쓰레드

  쓰레드는 한 프로세스 안에서 여러 개가 동작할 수 있다

  쓰레드는 각각 저마다 해야 되는 업무를 배정 받는다(일꾼)

  저마다 필요한 일들을 수행하게 되고 함수의 호출을 기억해야해서 쓰레드마다 스택이 할당되어져 있다

  프로세스 안에서 동작하는 쓰레드들은 결국 한 프로그램을 위해 일해야해서 프로세스에 지정된 코드와 데이터 힙들을 공통적으로 접근해서 공통적으로 업데이트가 가능

  프로세스는 동시다발적으로 발생 가능해서 프로세스가 좀 더 효율적으로 일할 수 있도록 함

  => 쓰레드는 일 흐름을 기억할 수 있는 고유의 스택이 지정됨, 데이터나 코드나 힙 같은 공통적인 데이터 리소스는 프로세스에 있으므로 쓰레드들은 이 프로세스에 공통적으로 할당된 리소스에 동시 다발적으로 접속해서 동시다발적으로 업데이트 해야해서 서로 공유하면서 사용

<br />

프로세스는 프로그래밍을 동작하는 최고의 단위

쓰레드는 프로그램 안에서 동시에 여러 개가 수행될 수 있는 작은 일꾼 단위

<br />

[목차로](#목차)

<br />

---

<br />

### 엔진_스택

<br />

멀티쓰레딩: 한 프로세스 안에서 여러 가지 쓰레드가 동시다발적으로 일어나는 것

멀티쓰레드를 가지고 있으면 동시적으로 일 수행 가능해서 효율적으로 프로그래밍 동작 가능

<br />

자바는 언어 자체에서 멀티쓰레딩 지원됨

하지만 자바스크립트는 single threaded language

자바스크립트 언어 자체에는 멀티쓰레딩 할 수 있는 방법 없지만 이 자바스크립트가 동작하고 있는 브라우저 위에는 즉 브라우저라는 프로그램 안에서는 여러 가지의 쓰레드가 들어있다

그래서 브라우저 즉 웹 APIs들을 이용하게 되면 멀티쓰레딩 가능

<br />

자바스크립트가 동작하는 런타임 환경에서는 다양한 방식을 이용해서 멀티쓰레딩같은 효과 얻을 수 있다

또 이벤트 루프를 이용해서 더 다양한 동작 실행할 수 있다

<br />

웹 어플리케이션이 브라우저 위에 올라가는 순간 자바스크립트 엔진이 소스 코드를 한 줄씩 해석하고 분석, 실행하는데

![JavaScriptEngine](./imgs/JavaScriptEngine.png)

메모리 힙과 콜 스택으로 나눠져 있다

메모리 힙은 데이터를 만들 때, 즉 변수를 선언해서 오브젝트를 할당하거나 문자열/숫자를 할당하게 되면 그 데이터들은 전부 다 메모리 힙에 저장된다

그리고 메모리 힙은 구조적으로 정리된 자료구조가 아니라 자료들이 여기저기에 아무곳에서나 저장되어져 있다

<br />

콜 스택은 함수를 실행하는 순서에 따라 차곡차곡 쌓아놓음

cf) 스택 <- LIFO (Last In First Out)

보통 스택에는 push와 pop peek 같은 API들이 있다

<br />

콜 스택은 함수들이 호출하는 순서를 기억했다가 함수가 끝나면 원래 있던 자리로 돌아가기 위해 쓰이는 자료구조 중 하나

모든 프로세스와 쓰레드 안에는 각각 저마다의 콜 스택이 들어가 있다

일을 수행할 때 어디서 왔고 어디로 다시 가야 되는지 정보를 기억해야 하므로

<br />

프로세스마다 또는 스택마다 지정된 콜 스택 사이즈가 있다

재귀 함수 쓸 때 유의

<br />

[목차로](#목차)

<br />

---

<br />

### 브라우저_런타임_환경_큐

<br />

자바스크립트 런타임 환경에서는 자바스크립트만으로 할 수 있는 것이 너무 한정적

![WebAPIs](./imgs/WebAPIs.png)

but 웹 APIs(브라우저에서 제공하는 API)

브라우저의 멀티쓰레딩을 이용해서 더 다양한 일들 동시에 실행 가능

<br />

ex) fetch <- 백엔드 데이터 받아오기

setTimeout <- 일정 기간의 시간이 지난 후 등록한 콜백 함수 실행

<br />

웹 APIs 와 자바스크립트 엔진이 어떤 식으로 대화하고 서로 협력하면서 일들을 수행하는지 보면,

cf) Queue 큐 <- FIFO (First In First Out)

![EventLoop](./imgs/EventLoop.png)

second() 함수 안에서 setTimeout()을 호출한다면 

setTimeout()을 호출하는 순간 setTimeout()은 콜 스택에서 지워지고 웹 API는 타이머를 시작한다

타이머와 자바스크립트 엔진은 병렬적으로 실행되다가 지정된 시간 끝나면 웹 APIs 는 태스트 큐에 콜백 자체(setTimeout 호출할 때 등록한 콜백)를 넣는다

<br /> 콜 스택과 태스크 큐를 관찰하는 이벤트 루프가 있는데

콜 스택이 비워질 때까지 기다리다가 비워져서 자바스크립트 엔진이 더 이상 일을 하고 있지 않을 때 이벤트 루프가 태스크 큐에 있는 콜백을 콜 스택에 데려와서 자바스크립트 엔진이 이를 실행하게 된다

<br />

태스크 큐에 있는 애는 콜 스택이 비워져있을 때 한번에 하나만 가져오게 된다

<br />

[목차로](#목차)

<br />

---

<br />

### 큰_그림

<br />



<br />

[목차로](#목차)

<br />

---

<br />

### setTimeout

<br />



<br />

[목차로](#목차)

<br />

---

<br />

### Promise

<br />



<br />

[목차로](#목차)

<br />

---

<br />

### RAF

<br />



<br />

[목차로](#목차)

<br />
